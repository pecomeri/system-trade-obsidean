# FX検証レビューコンテキスト（契約書）

## 1. 目的（Purpose）
本検証の目的は、  
**スヌーピングを抑制した状態で、個人トレーダーが継続可能な再現性ある優位性を発見・評価すること**である。

以下を明確に判断対象とする：
- 構造（レジーム × セットアップ × エントリー × フィルター）の妥当性
- 個別戦略の“当たり外れ”ではなく、**設計として回り続けるか**
- forward（将来データ）での破綻有無

「最大利益」や「最適パラメータ探索」は目的としない。

---

## 2. 前提・制約（Assumptions & Constraints）

### 時間軸
- 上位認識：H1（レジーム判定）
- 裁量構造：M5
- エントリー：10秒足

### 市場
- FX（主要通貨ペア）
- 取引コスト・スプレッドは現実的設定を前提

### 方針
- 機械学習・統計的最適化は使用しない
- チャート構造・ボラティリティ・時間帯など「構造的特徴」を重視
- 数値の微調整（最適化）は行わない

---

## 3. データ分割（Data Split Protocol）

### In-sample（設計・開発）
- 期間：2024年
- 用途：
  - 仮説生成
  - Setup / Entry / Filter の定義確定
  - ロジック実装と初期検証

### Verify（中間確認）
- 期間：2024年内の別区間（例：前半 / 後半）
- 用途：
  - in-sampleで作った定義の再現性確認
  - ここまでは定義修正可

### Forward（最終評価）
- 期間：2025年
- 用途：
  - **freeze 済みロジックの最終評価のみ**
  - この結果を見て定義・仕様は変更しない

forward は「1回だけ見る」。

---

## 4. 検証ワークフロー（Workflow）

1. レジーム仮説を定義する（10_regimes）
2. セットアップを定義する（15_setups）
3. エントリー条件を定義する（25_entries）
4. フィルターを定義する（27_filters）
5. Strategy としてコード化・検証（20_strategies）
6. in-sample / verify の結果を確認
7. 合格条件を満たした場合のみ freeze
8. freeze された実験IDのみ forward を実行
9. forward を見たら、その実験IDは終了

---

## 5. 変更ルール（Anti-Snooping Rules）

- 1実験につき「変更は1点のみ」
- 数値最適化は禁止（閾値変更は仮説変更として扱う）
- 結果を見てから定義文言を調整しない
- forward を見た後、その実験IDでは一切変更しない
- 新しい試行は必ず新しい experiment_id を切る

---

## 6. 合否評価指標（Pass / Fail Criteria）

以下を **すべて満たすこと** を最低条件とする。

- トレード数が極端に少なくないこと  
  （例：年あたり一定回数以上）
- 月次・セッション別での極端な偏りがないこと
- 最大DDが許容範囲内であること
- PF / 期待値が一貫して正であること
- フィルターによって「ほぼ常に見送り」になっていないこと

※ 数値の閾値はここでは固定しないが、  
「後から都合の良い指標を採用しない」ことを重視する。

---

## 7. Freeze ルール（Gate）

- freeze とは「仕様が確定した」ことを意味する
- freeze された experiment_id のみ forward を実行できる
- freeze 後は、定義・コード・条件を一切変更しない
- forward を見たら、その experiment_id は終了扱いとする

---

## 8. 実験管理（Experiment Registry）

- すべての検証は experiment_registry.csv に記録する
- family / baseline / variant の関係を明示する
- 「何を1点だけ変えたか」を必ず記載する
- 結果の良し悪しに関わらず、削除しない

---

## 9. この文書の位置づけ

この review_context.md は、
- メモではなく **契約書**
- 結果を見る前の意思決定を固定するためのもの
- 迷ったら、必ずここに戻る

とする。
